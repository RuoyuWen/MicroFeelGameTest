"""
配置文件
"""
import os
from typing import Optional

# API配置
OPENAI_API_KEY: Optional[str] = None
OPENAI_MODEL: str = "gpt-4"  # 使用gpt-4，如果4.1可用则改为gpt-4.1

# 默认Prompt模板
DEFAULT_PROMPTS = {
    "npc_generate_all": """请为一个游戏NPC生成完整信息：
- 姓名：一个符合游戏风格的名称
- 性别：{gender}
- 职业：{profession}
- 背景故事：一段引人入胜的背景故事（200-300字）

请以JSON格式返回，包含name, gender, profession, background字段。""",

    "npc_generate_background": """请为以下NPC生成一段引人入胜的背景故事（200-300字）：
姓名：{name}
性别：{gender}
职业：{profession}

背景故事：""",

    "location_generate": """请为一个游戏地点生成详细描述：
地点名称：{name}
描述：请生成一段生动的描述（150-250字），包括环境、氛围、特色等。""",

    "story_generate": """请根据以下信息生成一个完整的故事：

【参与的NPC角色】（这些NPC将作为故事中的主要或次要角色出现）：
{npcs}

【故事发生的地点】（故事的主要场景和背景环境）：
{locations}

故事风格：{style}

故事要求：
- 故事要有开头、发展和结局
- 符合指定的故事风格
- 故事必须发生在提供的地点中，充分利用地点的特色和环境描述
- 故事中必须包含提供的NPC角色，合理运用他们的背景故事、性格和职业特点
- 让NPC角色与地点环境产生互动，展现地点的氛围和NPC的性格
- 故事长度约800-1200字

请生成故事：""",

    "chapters_generate": """请将以下故事分成三个章节，每章都要有清晰的开头、发展和结尾。

【故事内容】：
{story}

【故事中出现的NPC角色】（这些角色必须在章节中出现）：
{npcs}

【故事发生的地点】（故事必须发生在这些地点中）：
{locations}

要求：
- 第一章：故事的开端，介绍主要角色和背景，必须发生在指定的地点中，包含指定的NPC角色
- 第二章：故事的发展，冲突和转折，继续使用指定的地点和NPC角色
- 第三章：故事的高潮和结局，确保所有指定的NPC角色都有合理的结局，地点环境得到充分利用

重要提示：
- 每个章节都必须包含指定的NPC角色，合理运用他们的背景故事、性格和职业特点
- 每个章节都必须发生在指定的地点中，充分利用地点的特色和环境描述
- 让NPC角色与地点环境产生互动，展现地点的氛围和NPC的性格
- 确保章节之间的连贯性，NPC和地点的使用要前后一致

请以JSON格式返回，格式如下：
{{
  "chapters": [
    {{"title": "章节标题（如：The Beginning、开端、启程等，不要用第一章、第二章）", "content": "章节的完整内容（纯文本字符串）"}},
    {{"title": "章节标题（如：The Conflict、冲突、转折等）", "content": "章节的完整内容（纯文本字符串）"}},
    {{"title": "章节标题（如：The Resolution、结局、终章等）", "content": "章节的完整内容（纯文本字符串）"}}
  ]
}}

注意：
- title字段应该是描述性的标题，不要使用"第一章"、"第二章"这种编号形式
- content字段必须是纯文本字符串，不要使用嵌套对象或字典。""",

    "chapter_refine": """请优化以下章节内容，使其与前后章节联系更加紧密：

【章节顺序信息】
这是第 {chapter_index} 章（共 {total_chapters} 章）
前一章：{previous_title}
当前章节：{current_title}
后一章：{next_title}

【章节内容】

前一章内容：
{previous_chapter}

当前章节：
{current_chapter}

后一章内容：
{next_chapter}

【优化要求】

请优化当前章节，使其：
1. **保留原有内容的核心和主要情节**，不要改变关键剧情点
2. **严格遵循章节顺序**：
   - 当前章节必须承接前一章的情节发展
   - 当前章节必须为后一章做好铺垫和准备
   - 剧情发展要有逻辑顺序，不能跳跃或倒置
3. **保持剧情连贯性**：
   - 角色状态、地点、时间线要与前后章节一致
   - 前一章结束的状态应该是当前章节的开始状态
   - 当前章节结束的状态应该能自然过渡到后一章
4. **增强情节张力和可读性**：
   - 在保持顺序的前提下，增加戏剧冲突
   - 确保剧情发展符合故事的整体节奏
5. **在保持原意的基础上进行润色和改进**

优化后的章节：""",

    "insert_chapter_refine": """请根据以下上下文，完善这个新插入的章节：

【章节顺序信息】
这是第 {chapter_index} 章（共 {total_chapters} 章），位于前一章和后一章之间
前一章：{previous_title}
当前章节：{current_title}
后一章：{next_title}

【章节内容】

前一章：
{previous_chapter}

当前章节（用户已写的部分内容）：
{current_chapter}

后一章：
{next_chapter}

【完善要求】

重要要求：
1. **必须保留用户已写的内容**，不要删除或重写
2. **严格遵循章节顺序**：
   - 当前章节必须承接前一章的情节发展
   - 当前章节必须为后一章做好铺垫和准备
   - 剧情发展要有逻辑顺序，不能跳跃或倒置
3. **保持剧情连贯性**：
   - 角色状态、地点、时间线要与前后章节一致
   - 前一章结束的状态应该是当前章节的开始状态
   - 当前章节结束的状态应该能自然过渡到后一章
4. 基于用户已写的内容进行**扩展和完善**，而不是全部重写
5. 在用户内容的基础上，补充完整的情节，使其与前后章节自然衔接
6. 保持用户原有的写作风格和故事方向
7. 如果用户只写了开头，请继续写下去；如果写了中间部分，请补充开头和结尾
8. 确保完善后的章节与前后章节连贯，故事流畅，符合整体剧情发展顺序

完善后的章节（必须包含用户原有的内容）："""
}

